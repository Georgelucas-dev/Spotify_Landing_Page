<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Spotify Landing Page</title>
  <link rel="shortcut icon" href="../assets/Spotify_logo.png" type="image/x-icon">
  <link rel="stylesheet" href="output.css">
</head>
<body class="bg-[#1db954] text-white h-screen overflow-hidden box-border">
  <div class="flex h-full w-full">

    <aside class="md:flex hidden flex-col md:w-32 bg-[#121212] h-full items-center py-6 justify-between">
      <img class="h-16 w-16" src="../assets/Spotify_logo.png" alt="Spotify's Logo">
      <div class="flex flex-col w-full items-center">
        <button id="#artistas" class="menu-button">Artistas</button>
        <button id="#musicas" class="menu-button">M√∫sicas</button>
        <button id="#albuns" class="menu-button">Albuns</button>
      </div>
      <a href="https://github.com/Georgelucas-dev"><img class="h-16 w-16" src="../assets/github-mark-white.png" alt=""></a>
    </aside>

    <!--Container com v√°rias se√ß√µes-->
    <main class="bg-[#212121] flex-1 min-h-screen p-10 overflow-auto flex gap-20 flex-col scroll-smooth">

      <div id="artista" class="w-full min-h-screen h-auto">
      <h1 class="text-4xl mb-4">Top Artists</h1>
      <div id="container-artists" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8">
        <!-- Os artistas ser√£o renderizados aqui -->
      </div>
      </div>

      <div id="musicas" class="w-full min-h-screen h-auto py-4">
      <h1 class="text-4xl mb-4">Top Songs</h1>
      <div id="container-songs" class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-3 xl:grid-cols-4 gap-8">
        <!-- As m√∫sicas ser√£o renderizadas aqui -->
      </div>
      </div>

    </main>
  </div>







  <script>
    async function getMultipleArtistsData() {
      try {
        // 1Ô∏è‚É£ Pega o token do nosso backend
        const tokenRes = await fetch('http://localhost:3000/token');
        const tokenData = await tokenRes.json();
        const accessToken = tokenData.access_token;

        // 2Ô∏è‚É£ Lista de IDs dos artistas que voc√™ quer buscar
        const artistIds = [
          '4MCBfE4596Uoi2O4DtmEMz', // Juice WRLD
          '1uNFoZAHBGtllmzznpCI3s', // Justin Bieber
          '06HL4z0CvFAxyc27GXpf02', // Taylor Swift
          '5xkAtLTf309LAGZTbvULBn'
        ];

        // 3Ô∏è‚É£ Buscar todos os artistas ao mesmo tempo (paralelo)
        const artistPromises = artistIds.map(id => getSingleArtist(id, accessToken));
        await Promise.all(artistPromises);

      } catch (err) {
        console.error('Erro ao buscar artistas:', err);
      }
    }

    // Fun√ß√£o para buscar um artista individual
    async function getSingleArtist(artistId, accessToken) {
      try {
        const artistRes = await fetch(`https://api.spotify.com/v1/artists/${artistId}`, {
          headers: {
            'Authorization': `Bearer ${accessToken}`
          }
        });
        const artist = await artistRes.json();
        
        // Renderiza o artista na p√°gina
        renderArtist(artist);
        
      } catch (err) {
        console.error(`Erro ao buscar artista ${artistId}:`, err);
      }
    }

    // Fun√ß√£o para renderizar um artista na p√°gina
    function renderArtist(artist) {
      const artistsCard = document.createElement('div');
      artistsCard.classList.add('flex', 'flex-col', 'justify-between', 'items-center', 'bg-[#121212]', 'rounded-lg', 'p-4', 'shadow-lg', 'hover:bg-[#282828]', 'transition-colors', 'cursor-pointer');
      
      artistsCard.innerHTML = `
        <div class="w-full h-52 mb-2">
        <img src="${artist.images[0]?.url || 'placeholder.jpg'}" 
             alt="${artist.name}" 
             class="w-full h-full object-cover rounded-lg">
        </div>
        <h3 class="text-lg font-bold text-white mb-2">${artist.name}</h3>
        <p class="text-sm text-gray-400 mb-2">${artist.followers.total.toLocaleString()} seguidores</p>
        <p class="text-xs text-gray-500 text-center">${artist.genres.slice(0, 2).join(', ')}</p>
      `;
      
      // Adiciona evento de clique para mostrar mais detalhes
      artistsCard.addEventListener('click', () => {
        showArtistDetails(artist);
      });
      
      document.getElementById('container-artists').appendChild(artistsCard);
    }

    // Fun√ß√£o para mostrar detalhes do artista
    function showArtistDetails(artist) {
      alert(`
        Artista: ${artist.name}
        Popularidade: ${artist.popularity}/100
        G√™neros: ${artist.genres.join(', ')}
        Seguidores: ${artist.followers.total.toLocaleString()}
      `);
    }

    // ==================== FUN√á√ïES PARA M√öSICAS ====================
    
    async function getTopSongsData() {
      try {
        // 1Ô∏è‚É£ Pega o token do nosso backend
        const tokenRes = await fetch('http://localhost:3000/token');
        const tokenData = await tokenRes.json();
        const accessToken = tokenData.access_token;

        // 2Ô∏è‚É£ Lista de IDs de m√∫sicas populares
        const trackIds = [
          '3T06rGO2dVEntMvym0vpQu', // Cut to the Feeling - Carly Rae Jepsen
          '0INehbMZOFPnaPBAjK97i3', // Blinding Lights - The Weeknd  
          '4uLU6hMCjMI75M1A2tKUQC', // Never Gonna Give You Up - Rick Astley
          '7qiZfU4dY1lWllzX7mPBI3', // Shape of You - Ed Sheeran
        ];

        // 3Ô∏è‚É£ Buscar todas as m√∫sicas ao mesmo tempo (paralelo)
        const trackPromises = trackIds.map(id => getSingleTrack(id, accessToken));
        await Promise.all(trackPromises);

      } catch (err) {
        console.error('Erro ao buscar m√∫sicas:', err);
      }
    }

    // Fun√ß√£o para buscar uma m√∫sica individual
    async function getSingleTrack(trackId, accessToken) {
      try {
        const trackRes = await fetch(`https://api.spotify.com/v1/tracks/${trackId}`, {
          headers: {
            'Authorization': `Bearer ${accessToken}`
          }
        });
        const track = await trackRes.json();
        
        // Renderiza a m√∫sica na p√°gina
        renderTrack(track);
        
      } catch (err) {
        console.error(`Erro ao buscar m√∫sica ${trackId}:`, err);
      }
    }

    // Fun√ß√£o para renderizar uma m√∫sica na p√°gina
    function renderTrack(track) {
      const trackCard = document.createElement('div');
      trackCard.classList.add('flex', 'flex-col', 'justify-between', 'items-center', 'bg-[#121212]', 'rounded-lg', 'p-4', 'shadow-lg', 'hover:bg-[#282828]', 'transition-colors', 'cursor-pointer');
      
      // Converte dura√ß√£o de ms para mm:ss
      const duration = formatDuration(track.duration_ms);
      
      trackCard.innerHTML = `
        <div class="w-full h-52 mb-2">
          <img src="${track.album.images[0]?.url || 'placeholder.jpg'}" 
               alt="${track.name}" 
               class="w-full h-full object-cover rounded-lg">
        </div>
        <h3 class="text-lg font-bold text-white mb-1 text-center">${track.name}</h3>
        <p class="text-sm text-gray-300 mb-2 text-center">${track.artists.map(artist => artist.name).join(', ')}</p>
        <p class="text-xs text-gray-400 mb-1">${track.album.name}</p>
        <div class="flex items-center gap-2 text-xs text-gray-500">
          <span>üéµ ${duration}</span>
          <span>‚≠ê ${track.popularity}/100</span>
        </div>
      `;
      
      // Adiciona evento de clique para mostrar mais detalhes
      trackCard.addEventListener('click', () => {
        showTrackDetails(track);
      });
      
      document.getElementById('container-songs').appendChild(trackCard);
    }

    // Fun√ß√£o para formatar dura√ß√£o (ms para mm:ss)
    function formatDuration(ms) {
      const minutes = Math.floor(ms / 60000);
      const seconds = ((ms % 60000) / 1000).toFixed(0);
      return `${minutes}:${seconds.padStart(2, '0')}`;
    }

    // Fun√ß√£o para mostrar detalhes da m√∫sica
    function showTrackDetails(track) {
      alert(`
        M√∫sica: ${track.name}
        Artista(s): ${track.artists.map(artist => artist.name).join(', ')}
        √Ålbum: ${track.album.name}
        Dura√ß√£o: ${formatDuration(track.duration_ms)}
        Popularidade: ${track.popularity}/100
        Lan√ßamento: ${track.album.release_date}
      `);
    }

    // ==================== INICIALIZA√á√ÉO ====================
    
    // Chama as fun√ß√µes para carregar os dados
    getMultipleArtistsData();
    getTopSongsData();
  </script>
</body>
</html>
